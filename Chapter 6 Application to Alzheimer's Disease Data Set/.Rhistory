setwd("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/Conditional AUC P-splines Estimate")
adni_noNA <- read.csv("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/adni_noNA.csv", header=FALSE)
View(adni_noNA)
knitr::opts_chunk$set(fig.path = "README_figs/README-")
library(mgcv)
ADNI <- read.csv("~/adni_noNA.csv")
wd
lwd
ADNI <- read.csv("~/Conditional AUC P-splines Estimate/adni_noNA.csv")
load("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/adni_noNA.csv")
library(readr)
adni_noNA <- read_csv("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/adni_noNA.csv")
View(adni_noNA)
knitr::opts_chunk$set(fig.path = "README_figs/README-")
library(mgcv)
ADNI <-read_csv("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/adni_noNA.csv")
setwd("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set")
library(readr)
adni_noNA <- read_csv("adni_noNA.csv")
View(adni_noNA)
setwd("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/Conditional AUC P-splines Estimate")
setwd("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set")
knitr::opts_chunk$set(fig.path = "README_figs/README-")
library(mgcv)
ADNI <- adni_noNA <- read_csv("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/adni_noNA.csv")
knitr::opts_chunk$set(fig.path = "README_figs/README-")
library(mgcv)
ADNI <- adni_noNA <- read_csv("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/adni_noNA.csv")
knitr::opts_chunk$set(fig.path = "README_figs/README-")
library(mgcv)
ADNI <- adni_noNA <- read_csv("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/adni_noNA.csv")
library(readr)
adni_noNA <- read_csv("adni_noNA.csv")
View(adni_noNA)
library(readr)
adni_noNA <- read_csv("adni_noNA.csv")
View(adni_noNA)
knitr::opts_chunk$set(fig.path = "README_figs/README-")
library(mgcv)
ADNI <- adni_noNA <- read_csv("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/adni_noNA.csv")
knitr::opts_chunk$set(fig.path = "README_figs/README-")
library(mgcv)
ADNI <- read_csv("~/GitHub/Statistical-Evaluation-of-Medical-Tests/Chapter 6 Application to Alzheimer's Disease Data Set/adni_noNA.csv")
ps_est_fun <- function(y, x, x_pred) {
# Returns the mean and variances functions estimates for P-splines estimator
# Step 1
##  Fits model for observation samples
fit <- gam(y ~ s(x, bs = "ps"))
df_pred <- data.frame(x = x_pred)
##  Obtains mean estimate
mean_fitted_values <- fit$fitted.values
mean_pred <- predict(fit, df_pred)
# Step 2:  Transform working responses and fits model
y_wr <- log((y - mean_fitted_values)^2)
fit_wr <- gam(y_wr ~ s(x, bs = "ps"))
# Step 3: Obtain covariates and derive theta
cov <- exp(fit_wr$fitted.values)
theta_hat <- sum(((y - mean_fitted_values)^2) * cov)/sum((cov)^2)
# Calculate sigma estimate
sigma2_fitted_values <- theta_hat*exp(fit_wr$fitted.values)
sigma2_pred <- theta_hat * exp(predict(fit_wr, df_pred))
return(list("mu_fitted" = mean_fitted_values,
"sigma2_fitted" = sigma2_fitted_values,
"mu_pred" = mean_pred, "sigma2_pred" = sigma2_pred))
}
knitr::opts_chunk$set(fig.path = "README_figs/README-")
library(mgcv)
ADNI <- read.csv("~/1. University of Edinburgh/1. Dissertation/adni_noNA.csv")
